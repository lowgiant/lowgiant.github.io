{"componentChunkName":"component---src-templates-post-jsx","path":"/OSSCA-3-week/","result":{"data":{"site":{"siteMetadata":{"title":"Lowgiant"}},"markdownRemark":{"id":"71146c25-aed5-5c5a-9561-c33489800318","excerpt":"목표 레디스에 명령어를 만들 계획입니다. 명령어를 만들면서 '내부 구조'를 이해하려는게 핵심 기존에 만들어진 echo 명령을 참조해 명령 추가하기 echo 명령 후 출력 값에 접두사를 SY를 추가해보도록 하겠습니다. echo란?  echo는 받은 내용을 그대로 다시 돌려주는 명령입니다. ex: echo hello 출력 값에 hello가 보여집니다. 이 명…","html":"<h2>목표</h2>\n<ul>\n<li>\n<p>레디스에 명령어를 만들 계획입니다.</p>\n<ul>\n<li>명령어를 만들면서 '내부 구조'를 이해하려는게 핵심</li>\n</ul>\n</li>\n<li>\n<p>기존에 만들어진 echo 명령을 참조해 명령 추가하기</p>\n<ul>\n<li>echo 명령 후 출력 값에 접두사를 SY를 추가해보도록 하겠습니다.</li>\n</ul>\n</li>\n</ul>\n<h2>echo란?</h2>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 250px; '>\n      <a class='gatsby-resp-image-link' href='/static/4f1fd9e3baacc07c18eed68bedd62f03/86700/echo.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 17.058823529411764%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAuElEQVR42jWN566CQBBG124sV12kKAtYiI0iigZjSa7v/1DHxfLj5MxMvswnolVIslkRTGwOcUQW7VgvZviOxSU/cD2f+L9fCQOPpedSHDOe9xtzNeW0T8jTmHOWsp4HNIVA5EmMssYslMvSV4S+x8SQGP0e7ljiyCHm4A/Z62o6KNt8I/tdLH13jBH2aKgZ0Kroh2XToyhIt5t3k7JMarqpVa3Q0C5p6mAZLl3Xe/07N36Ij9tVwQu+dEzjvvL/EgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='echo command' title='' src='/static/4f1fd9e3baacc07c18eed68bedd62f03/86700/echo.png' srcset='/static/4f1fd9e3baacc07c18eed68bedd62f03/e7570/echo.png 170w,\n/static/4f1fd9e3baacc07c18eed68bedd62f03/86700/echo.png 250w' sizes='(max-width: 250px) 100vw, 250px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>echo command</figcaption>\n  </figure></p>\n<ul>\n<li>\n<p>echo는 받은 내용을 그대로 다시 돌려주는 명령입니다.</p>\n<ul>\n<li>ex: echo hello</li>\n<li>출력 값에 hello가 보여집니다.</li>\n</ul>\n</li>\n<li>\n<p>이 명령어는 레디스에 만 있는 것은 아닙니다.</p>\n<ul>\n<li>유닉스 초판(1969~70)부터 만들어진 명령어로 레디스에서도 필요해서 만들었을 것입니다.</li>\n</ul>\n</li>\n<li>이 밖에 영어 뜻은 메아리 이지만, 주로 노래방 기계에 에코 설정한다고 할 때 많이 들어서 그 에코로 이해하면 편하지 않을까 싶습니다. </li>\n</ul>\n<h2>개발 전 Redis CLI 명령어 확인</h2>\n<ul>\n<li>만들려고 하는 명령어 이름은 'echoSiYeon'입니다.</li>\n<li>Redis CLI 상태에서 만들기 전에 명령어를 입력 해서 어떠한 에러가 나오는 지 확인 해보겠습니다. </li>\n</ul>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/94a3d931b8d3c4ab2a9ff48d6040fc7a/312cc/unkwon-command.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 54.11764705882353%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABb0lEQVR42pWR2U7CQBSGC8oiq2BBRRM0ohcaY1i7lwJlyqYPYIgXGg3v/wK/50xohehFvfhy2jOZb/45owSLANOXZ7hvG7ivn/DWH/ja+HhfW3BMC0ObsEz0nh5xd92U3Ldu0GycoV4p46RUgErUykWJMp8FWIgphG3Ct3TCgGsO4TkjiPEIY9eBZ9t4uG3hqnGOy3oNDbWKU5KxoJTN4DiXRbWQRyWfgzLzJ5iTcDWfSxZ0wDKYIpiMiQkEVZZe1FXanEa1mEf2IImUoiCT+I2yFIISCiylSGA1m8lkLPRHnpQxarmEQ5YkEyRM4GhLNqnsofAmntHIselqVlQZl/qOadC6QcIi0iT8S7InHHTaYPReF1q3g/A/hHu8xsOPJXQNfgQD5qAfYfR7shfCN+AHSMUR2poWSXaFlq7BJhxDl6hxhbvJLG0g4e8pzXbiDSNpbCELZKKtaDctz27Qbv9vhmb/R7IrYsJ0XOMKvwE8qDRFOtE1jQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='unkwon command' title='' src='/static/94a3d931b8d3c4ab2a9ff48d6040fc7a/ca1dc/unkwon-command.png' srcset='/static/94a3d931b8d3c4ab2a9ff48d6040fc7a/e7570/unkwon-command.png 170w,\n/static/94a3d931b8d3c4ab2a9ff48d6040fc7a/f46e7/unkwon-command.png 340w,\n/static/94a3d931b8d3c4ab2a9ff48d6040fc7a/ca1dc/unkwon-command.png 680w,\n/static/94a3d931b8d3c4ab2a9ff48d6040fc7a/02d09/unkwon-command.png 1020w,\n/static/94a3d931b8d3c4ab2a9ff48d6040fc7a/312cc/unkwon-command.png 1182w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>unkwon command</figcaption>\n  </figure></p>\n<ul>\n<li>\n<p>(error) ERR unknown command 'echoSiYeon', with args beginning with: 'Hello'</p>\n<ul>\n<li>만들기 전에 이러한 에러 메시지를 받는 것을 알 수 있습니다.</li>\n<li>이 에러가 안 나오게 한 후 출력값이 SYHello가 나오도록 해보겠습니다.</li>\n</ul>\n</li>\n</ul>\n<h2>echoSiYeon 명령어 개발하기</h2>\n<ul>\n<li>\n<p>환경</p>\n<ul>\n<li>인텔 맥</li>\n</ul>\n</li>\n</ul>\n<h3>1. echo 관련 파일 찾기</h3>\n<ul>\n<li>redis repo에서 echo 검색 해보기</li>\n</ul>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 290px; '>\n      <a class='gatsby-resp-image-link' href='/static/137dd80f67861d3e84323c59c63ad28c/bd800/echo-search.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 71.17647058823529%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB8ElEQVR42p2TbW/TMBDH8/0/C29AIN6giU1ijBVUNFptXZqnJmmXNG1oEz8n+XN2N2kqq8Sw9Mvd2eeL/bftgVq1qVGUGwgpUZYlGGfo+x7/0zz7mfkhbiYzrKsK795/wOfzCzRN6xKGYXh9QaU1lNJ45dyXC9oVaG0gqaAia7re2af4FJLQpoMhpDrkW+tWWG1/424eYpEt8ensnCQIXDIXinTVf8G4xLbeka8c2apEywX8MLEFBzRMYNdK1HuGdFmiqhu0QqPh6gQSeyYpR4HRD3YNd/GuFfCUGTDNBO7yBkEpERQSYakQrv+BSiGqNKHc3OvZA7xWDrhfchRFgTRf4dv1d8Txwgnc94M7qNMMLsc2q+Gbtx/hmW7AbCUxoVVOMo5JyvAr5Qef+qb5c+Rj/8uMoz1pOHRYbDRu4h2CB4aoFLRl6awlKDjFwo35ywbxWjrsnGPSuoPXGQV/RVokGdZlgTAMEARz2nbkbGTjuY/xjxGuLr8gTxfI8/z0PTRaIq+N26oVNq4MCW6FNo5k2z0KbxBvDoRr29+7vGM8Se+3I2HncYYkpxUmS8yChEhx68dEhNt5gtHPKc4uLvF1NMZ9uHBjTNKFplvyHFfQnpYQgp6fgpSCfA5F/Rbr27GmobtpaRtwxvA073jLfwDOIi2COoSqzQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='echo 관련 파일 검색' title='' src='/static/137dd80f67861d3e84323c59c63ad28c/bd800/echo-search.png' srcset='/static/137dd80f67861d3e84323c59c63ad28c/e7570/echo-search.png 170w,\n/static/137dd80f67861d3e84323c59c63ad28c/bd800/echo-search.png 290w' sizes='(max-width: 290px) 100vw, 290px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>echo 관련 파일 검색</figcaption>\n  </figure></p>\n<ul>\n<li>\n<p>크게 두가지를 확인 할 수 있습니다.</p>\n<ul>\n<li>echo.lua(테스트 관련 코드로 보입니다.)</li>\n<li>echo.json(명령어에 대한 정보가 있을 듯 싶습니다.)</li>\n</ul>\n</li>\n</ul>\n<h3>2. lua 테스트 코드 작성</h3>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/ebb2f13b63b72ed4369cd3718ea86686/6fa0c/Redis-lua-version.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 45.294117647058826%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABUElEQVR42o2S6W6DMBCEef8XbNVAAgmnOWzA4Uw63VkFqWr/xNIIe23P7n4maNoW1vV4Z3y/cSbo+x513aBpGpi6RmUMqqoSGRRFiaIsNVZKzJha9zTG/bLSu5xnWQ7vPQIuTmGIOE5wEUXnC8IowukUqomThNY61JKw66xK5xJjEdyzVmJSzDRNCNjuLU1RSlZWcIiXxtGj7wcMg2gc9Tu+vsMw6h4TOvGwzmFZVgTMGCeJlpzluZhnSLNMDxMHDahjTeP+ZcaKHo8H9n1XPZ9PBPOyKCtWxPbJkVyYgFWTFxORo/d3zGJCI3+/Y9u2/4/CYF4UeomQk+tNlfNBRGmaK8uu67RStqitSotOK/bKc5rnw3DXh/j4/JLHiVTRORYMV5wvsc5pSPhMQiRG/4pW1Uoidkfu6yoM2Tc5WhEPEAEH479FVtuLFed/dTD8AT3YrYt51TrzAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='Redis lua version' title='' src='/static/ebb2f13b63b72ed4369cd3718ea86686/ca1dc/Redis-lua-version.png' srcset='/static/ebb2f13b63b72ed4369cd3718ea86686/e7570/Redis-lua-version.png 170w,\n/static/ebb2f13b63b72ed4369cd3718ea86686/f46e7/Redis-lua-version.png 340w,\n/static/ebb2f13b63b72ed4369cd3718ea86686/ca1dc/Redis-lua-version.png 680w,\n/static/ebb2f13b63b72ed4369cd3718ea86686/6fa0c/Redis-lua-version.png 881w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>Redis lua version</figcaption>\n  </figure></p>\n<ul>\n<li>\n<p><a href=\"https://github.com/redis/redis/tree/unstable/deps#lua\">레디스</a>는 lua 5.1 버전을 사용합니다.</p>\n<ul>\n<li>맥에서 최신 버전은 5.4로 확인 했습니다.</li>\n<li>버전 별 명령어가 크게 차이가 있어서 레디스 기준인 5.1 버전으로 작성하는 것을 추천드립니다.</li>\n<li>lua 설치는 아래 코드로 했습니다.</li>\n<li>brew install lua@5.1</li>\n</ul>\n</li>\n</ul>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 544px; '>\n      <a class='gatsby-resp-image-link' href='/static/00ec08b4429cd565667742136bddbc14/cfd82/echoSiYeon-lua-test.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 102.35294117647058%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD0klEQVR42o2U+1cTVxDH7z6T3SQkIa8NeScEkgASFEUEFRAxgvIGoaBNUanAaWnVX9pf2nP6h386G8Jp6+PUHz5ndnb3zp3vnbmjoo1x4rkYI5Uyk40RKtP3cOs3cMoNnEoTt9rCEeziCJZPvtazdrGOXmySa+a4M65krcbkqEKFggHyXpp8OkmjVqFVLpKJhBiKRSmnEjTyWWpeiohhEFQK5xMsQQlaH+XFY6SiA2QTgxQyaTLJBIXcEPmhLNm+b5sSzPIxP8O1dSK2ItxHlXNZRqtl6qUirXqNdr1KKRFjMGCScgLE/UWyc/ArXGd4naUaH66QTyVlJ4tY0MautzEm76O3ZjDbD7BuzBGYeoA9PiPMYotvy/fA5Dx6e5HhuVHWHio6CxrLcxJwqDmGl09SFpm3miNktk+Jv/mD2MEl+sYZxtprjM0zrPVTzPW3WKtdrM1z7I1T1Pols2dP+fNS8f7M4MM7DZUdrpPIxKgV89ycGGdmvEm7VhbpNSpSqEIiTjLkYn9Fst2Xql9LjshhJ8Ih0lIc/zyH5SzHRobxJFA6HiUWcnD9AhjaFbr2z3Mf15CK91EBXRF1A722KUj7DCUHSQ6EKWU9il4GxzQxZeeAJhnp/4/yf4y6QfKZFDkpjh8wJr7/7Ei7JCR4tZAjI9l+U0DX1Hs/ZyXQYNglLk0dlmoPSFBHpEZdh5Q0ue8HDf0zHFkfMlVPtitWlYa83qKAnI3hy9L+e+iBfq8FvlCQT29Krx/9zPzbEpfsstEwxt1V9OdvMR9/h7l2gvXkJbZvxbdWjq7s0y7201eozinT3WU+vlGcdQ0uutI2mdYkg9Uk0ewgN4arVNYOKRxckN86wdv4AXvuGdb8Ovbsag/rbgdr7jmB+Wdoc1tMrE3xalNxuKmz3ZEMU56H8gsTDtIea9HKyF2Wqg9I+j7uFwbCNf43819Xr0dZqptwXNLRKBNyDd3556jHx2gLe+grL9EX98UeYz16ccXyAVbnFXbnCLVyws3D+1x2RfL3Oq8Pfcljk6TqHgMiuVEqUN05ofLmd3K7P+Ltn1M6/oX07jushR1hF+vBJtbSHvbiDmrpiJv7s5wfK7ovdF7uSsCkl+2lOhAKcnuqzb16hXYmTiMeoRxxr6Rr2rdLLkgDR51gbyZOyXDILa0TWtjCmn7UK4I5vYw18wT71hK2/+72Mrbvz6yg3XlGY2WKg1XFVkdn84kEbE7P0KyUiMjs8+RWGIt7mIcfZaK8w9z7GXPrAkus5U+cLUGmjLX7E/bOBWr7A/PnK/z1XvHbpc6vpxp/A3AUD/39gEpvAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='echoSiYeon lua test' title='' src='/static/00ec08b4429cd565667742136bddbc14/cfd82/echoSiYeon-lua-test.png' srcset='/static/00ec08b4429cd565667742136bddbc14/e7570/echoSiYeon-lua-test.png 170w,\n/static/00ec08b4429cd565667742136bddbc14/f46e7/echoSiYeon-lua-test.png 340w,\n/static/00ec08b4429cd565667742136bddbc14/cfd82/echoSiYeon-lua-test.png 544w' sizes='(max-width: 544px) 100vw, 544px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>echoSiYeon lua test</figcaption>\n  </figure></p>\n<ul>\n<li>echo 코드를 보고 접두사를 추가해 보았습니다.</li>\n</ul>\n<h3>3. command json 어떻게 사용되는지</h3>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/2ee8d93b46bf48b1a1bfb859710e88b3/bd64a/commands.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 21.764705882352942%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAq0lEQVR42qVQSQrDMAzM/x+XQpt9vyS2HGcFBwJ2pnLopfRYwaDRjEBLsKwr2rZDw9B6grUO/0Sw7zuElDcGIUBqhCS6uSTFOkEIguRMimv2iPW+HzBqjX4Qd6/n1loEQkiE4QNRnCBJM6RZzjzG8xWhqmo0TYe8KPmCFlVdoywrFB9433tey/MCxhwIzGGgeKt5XrBtG08jTMx9fZ4nruuCc+4L/i2/mr173+NsLpIPSIPgAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='commands' title='' src='/static/2ee8d93b46bf48b1a1bfb859710e88b3/ca1dc/commands.png' srcset='/static/2ee8d93b46bf48b1a1bfb859710e88b3/e7570/commands.png 170w,\n/static/2ee8d93b46bf48b1a1bfb859710e88b3/f46e7/commands.png 340w,\n/static/2ee8d93b46bf48b1a1bfb859710e88b3/ca1dc/commands.png 680w,\n/static/2ee8d93b46bf48b1a1bfb859710e88b3/bd64a/commands.png 851w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>commands</figcaption>\n  </figure></p>\n<ul>\n<li>\n<p><a href=\"https://github.com/redis/redis#commandsc\">레디스</a>는 src/commands 폴더의 json 파일은 utils/generate-command-code.py 파일에 의해 COMMAND 명령에 관련된 메타데이터를 만듭니다. </p>\n<ul>\n<li>echoSiYeon.json을 만들도록 하겠습니다.</li>\n</ul>\n</li>\n</ul>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 678px; '>\n      <a class='gatsby-resp-image-link' href='/static/75255e11c9015b6a92de76fdc7d605fb/dc057/echoSiYeon-json.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 127.6470588235294%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAAAsTAAALEwEAmpwYAAADD0lEQVR42p1V63aiMBjsa+wqgRAwXEVAKlqpvW+33Z/7/q8yO/mkPXZPbW1/zEmUZPgu8w1nZWEQxzF04MNXU0TGwIShrNZa2TvMeCYeEZoQvu8LggO432cmVPCDAIt+QHf9gGp9KWuWl7CxxWQ6hecpTD3vDZRShC+re+5WIXRkWmtEM4u8XqK/f8bq7gn5okVdZNjUJboyQ5VZtEWKlvsl0eQJktjI/+fzHHWeImQmZ8FI6EKepQVWN7/RXT2gHW74ghaFjYV0niVj+hohz2vek7tEyP+M4+B+T8iDjjAjwfnNI5otydIUF02F3bLCelFgySgM6/qS2iHUCEn5NUI2xRZzLHf3qFYXSBjZglF1JIoiI3XzXL1GvEd8QLiPMCkXaC6uMF/2qJoGdsauah8pa5Vxn8YRMr4oJyxf8gHhPn/Lzva3T1iyhvP+UhrTdx26RcUGpWgIF3FfFShSK3eOEmrN4kaxRLfZ7jBs1thdXSOrGigdMU1fUp16e3ySshaIUJWHiyrHr76mXNJR8N6rcA9F/DmhSCDErqsxtAt237ybln8qoZ5ljEbBMCrte5hMfsLjpHyL8KXLVbdGSThxN5tLtJuBgs+hwogX1NciDAItKQ9dg8dhgw3T3q1aGkUowg2+FCFhsjlneiYddMTGRPLs1QRGQb+YwYvIj+owthz+4Rb1ZicCX939Yfo9Alsg4rwmFHbMaJ2oD9fjXaY8NOd1xXl2Naz7Lbr1Fm3bcgwtHSURuJF00+L2bZm/UcJbQs3h96ZIigppVdNBAuQcu5oEKUdv4nyQjVEHKauPUrYV7apdoVyuZUKiJIcXxqyZJ4f3lnVql7maeIb6vEXT93SeSkzDJ5TaO/Zk6h0duXdTdoe1P4Ga/mB0mdiYpQZL1qule3fzDHky+5D0Px0yJb3vWt502D7/Rc7UazZkaCvcnNf8WJnTCZWv+WHyKWT3MEBkE9GnO+NsPwrDz1N2Fw1NQOzdWCm6FN51kB2X1Vn8aF+fTkoY+vK5TClqsafx4/NdnKVWnTSjp7rNPzbw44rS8sHKAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='echoSiYeon json' title='' src='/static/75255e11c9015b6a92de76fdc7d605fb/dc057/echoSiYeon-json.png' srcset='/static/75255e11c9015b6a92de76fdc7d605fb/e7570/echoSiYeon-json.png 170w,\n/static/75255e11c9015b6a92de76fdc7d605fb/f46e7/echoSiYeon-json.png 340w,\n/static/75255e11c9015b6a92de76fdc7d605fb/dc057/echoSiYeon-json.png 678w' sizes='(max-width: 678px) 100vw, 678px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>echoSiYeon json</figcaption>\n  </figure></p>\n<ul>\n<li>json을 추가 한다고 해서 명령어가 만들어지는 것은 아닙니다.</li>\n</ul>\n<h3>4. 레디스 서버의 진입점 server.c</h3>\n<ul>\n<li>\n<p><a href=\"https://github.com/redis/redis#serverc\">server.c</a>는 7천 줄이 될 만큼 레디스의 중심이 되는 코드 입니다. </p>\n<ul>\n<li>pingCommand(4519 line) 밑에 echoCommand가 있습니다.</li>\n<li>\n<p>echoSiYeonCommand를 만들도록 하겠습니다. </p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">void</span> <span class=\"token function\">echoSiYeonCommand</span><span class=\"token punctuation\">(</span>client <span class=\"token operator\">*</span>c<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\nsds prefixSYtoEcho <span class=\"token operator\">=</span> <span class=\"token function\">sdscatprintf</span><span class=\"token punctuation\">(</span><span class=\"token function\">sdsempty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"SY%s\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>c<span class=\"token operator\">-></span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">-></span>ptr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">addReplyBulkCBuffer</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> prefixSYtoEcho<span class=\"token punctuation\">,</span> <span class=\"token function\">sdslen</span><span class=\"token punctuation\">(</span>prefixSYtoEcho<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">sdsfree</span><span class=\"token punctuation\">(</span>prefixSYtoEcho<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</li>\n<li>\n<p>sds는 \"Simple Dynamic Strings\"의 약자로 동적 문자열을 효율적으로 다룰 수 있는 레디스의 데이터 형식입니다.</p>\n<ul>\n<li>또한 sds는 레디스를 만든 Salvatore Sanfilippo가 대부분을 만들었습니다(외 5명). </li>\n<li>명령어에 대한 자세한 정보는 <a href=\"https://github.com/antirez/sds\">sds repo</a>를 참조 하시면 됩니다.</li>\n</ul>\n</li>\n<li>addReplyBulkCBuffer 함수를 사용해 레디스 클라이언트에게 응답을 보냅니다. </li>\n<li>sdsfree 함수를 사용해 메모리 누수를 방지했습니다.</li>\n</ul>\n</li>\n</ul>\n<h3>5. server.c 있으면 server.h 있겠죠.</h3>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">void</span> <span class=\"token function\">echoSiYeonCommand</span><span class=\"token punctuation\">(</span>client <span class=\"token operator\">*</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>위 코드를 추가 했습니다. </li>\n</ul>\n<h3>6. 명령어 코드 완료. 'make'하자</h3>\n<ul>\n<li>make 명령어 실행</li>\n<li>\n<p>코드 동작 하는 redis cli 확인\n<figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/db8d3a376634a33e70b4d088af9c0699/487e7/echosiyeon-make.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 44.705882352941174%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABy0lEQVR42n2R208TQRTGZ8utC7YqN8MWlfgA8QGK7Xa73Xs7e+vWeHkSo0RCO6KR/8DEAA/go4YEnvhbP8+MtiaS+PDlO3ty9jfnm2Ffjo/x+WgE8fUMhxeXEOc/MPp+hZOfJ7i5HuL0m4AYCpoR+CQEjsQIH4eHONh/j+HBB1VL7b/dw7u9N2A+78KPXLicww57sP0ILS+EF9gokhZ4YME2TViNXfIGmvU6HtcMLFYrqOg6qgvz5GVomgbGGNirQYGXgwFeF30UvIesGyHvdQkUII9zZDxGnnBSjIT6fsfG9tYmnqwbqK0s4eGDVWwYa6qulufA+lmCfiqV4gVBn+eZUkE96XnMleR3HscKuPN0C5sbj1BbXVagdfK1pfu4MztNQAIVpD5tMMgyUqqU0RXwMEBMG/MoRNf30At8OC0TxvIiVu5WYBDs3oKOGYpaLv0Wk5CUomQUV26SytjkCYHkIbKO/wDlAbbZxFxJw4zGMKv9BU2ActCz22rQsVro0AZS9tipLyVrt23Ro2xjfrqkftantNtAc7dOL/gMHcucAMeQMWjck8DGDgGnSrdAE2DouSrKv1u2mw0FiChB6DoIHUfdoZzR/wP8BcZQH20RY5ygAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='echoSiYeon' title='' src='/static/db8d3a376634a33e70b4d088af9c0699/ca1dc/echosiyeon-make.png' srcset='/static/db8d3a376634a33e70b4d088af9c0699/e7570/echosiyeon-make.png 170w,\n/static/db8d3a376634a33e70b4d088af9c0699/f46e7/echosiyeon-make.png 340w,\n/static/db8d3a376634a33e70b4d088af9c0699/ca1dc/echosiyeon-make.png 680w,\n/static/db8d3a376634a33e70b4d088af9c0699/487e7/echosiyeon-make.png 935w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>echoSiYeon</figcaption>\n  </figure></p>\n<ul>\n<li>계획 한대로 작동이 잘 됐습니다. </li>\n</ul>\n</li>\n</ul>\n<h2>PS</h2>\n<ul>\n<li>Redis ReadMe를 세부적으로 읽으면서 동작 원리를 이해하려고 노력했습니다.</li>\n<li>오랜만에 c언어와 처음 보는 lua는 이젠 조금 코드가 보이기 시작하네요. ㅎ</li>\n<li>남은 한주도 마무리 잘하시길 기원합니다.</li>\n</ul>","frontmatter":{"title":"3주차-Redis 명령어 만들기","date":"October 22, 2023","update":"October 22, 2023","tags":["Redis"],"series":"OSSCA Redis"},"fields":{"slug":"/OSSCA-3-week/","readingTime":{"minutes":4.995}}},"seriesList":{"edges":[{"node":{"id":"69f5fe8a-9052-57c3-85b6-c109e6f89503","fields":{"slug":"/OSSCA-1-week/"},"frontmatter":{"title":"1주차-Git"}}},{"node":{"id":"dddbe019-d901-53f9-b1f3-0de4f3d9c41e","fields":{"slug":"/OSSCA-2-week/"},"frontmatter":{"title":"2주차-Redis Build"}}},{"node":{"id":"71146c25-aed5-5c5a-9561-c33489800318","fields":{"slug":"/OSSCA-3-week/"},"frontmatter":{"title":"3주차-Redis 명령어 만들기"}}}]},"previous":{"fields":{"slug":"/OSSCA-2-week/"},"frontmatter":{"title":"2주차-Redis Build"}},"next":null},"pageContext":{"id":"71146c25-aed5-5c5a-9561-c33489800318","series":"OSSCA Redis","previousPostId":"dddbe019-d901-53f9-b1f3-0de4f3d9c41e","nextPostId":null}},"staticQueryHashes":[],"slicesMap":{}}