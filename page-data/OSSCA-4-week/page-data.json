{"componentChunkName":"component---src-templates-post-jsx","path":"/OSSCA-4-week/","result":{"data":{"site":{"siteMetadata":{"title":"Lowgiant"}},"markdownRemark":{"id":"5a046d0b-e326-5871-8f18-0598fb3645fc","excerpt":"목표 지난주에 만든 접두사 명령어 코드를 접미사로 변경하기  코드 품질 높이기 sdscatfmt, addReplyBulkSds echoSiYeon 명령어 코드 품질 개선하기 환경 인텔 맥 Clion vscode에서 디버깅 힘들어서 넘어왔는데 개발하기 너무 편합니다. intellij만 좋은 게 아닙니다. Before(접두사)  sds repo 공식 레포에서…","html":"<h2>목표</h2>\n<ul>\n<li>지난주에 만든 접두사 명령어 코드를 접미사로 변경하기 </li>\n<li>\n<p>코드 품질 높이기</p>\n<ul>\n<li>sdscatfmt, addReplyBulkSds</li>\n</ul>\n</li>\n</ul>\n<h2>echoSiYeon 명령어 코드 품질 개선하기</h2>\n<ul>\n<li>\n<p>환경</p>\n<ul>\n<li>인텔 맥</li>\n<li>Clion</li>\n<li>vscode에서 디버깅 힘들어서 넘어왔는데 개발하기 너무 편합니다.</li>\n<li>intellij만 좋은 게 아닙니다.</li>\n</ul>\n</li>\n</ul>\n<h3>Before(접두사)</h3>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">void</span> <span class=\"token function\">echoSiYeonCommand</span><span class=\"token punctuation\">(</span>client <span class=\"token operator\">*</span>c<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    sds prefixSYtoEcho <span class=\"token operator\">=</span> <span class=\"token function\">sdscatprintf</span><span class=\"token punctuation\">(</span><span class=\"token function\">sdsempty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"SY%s\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>c<span class=\"token operator\">-></span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">-></span>ptr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">addReplyBulkCBuffer</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> prefixSYtoEcho<span class=\"token punctuation\">,</span> <span class=\"token function\">sdslen</span><span class=\"token punctuation\">(</span>prefixSYtoEcho<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">sdsfree</span><span class=\"token punctuation\">(</span>prefixSYtoEcho<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 616px; '>\n      <a class='gatsby-resp-image-link' href='/static/807e28c3d34eaab9100a132451f66a54/274fb/sdscatprintf.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 87.64705882352942%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAACJ0lEQVR42pVU2ZLbMAzzf+TyJcqWfMdJ281M+9L//yUWoI/uNDvZ7QOGDKWhCQJKUpSVhthrHTotpVbngzpEX0UtXKVZISrIBXXW/Jb7JfK+GKLlSV54+8GLWS56vuSG0znbsdXe45IWH+SFJpzA+WUaJ0FLVwOV+rrRClgm5nSNMbAzfNxqnAz5xizLHRpiKqOyNjB6QBVaWwMb8cziCp6RJmNVLznvcFWgLPtUH1F7ovrJeZJizLz0tvwTd7fieMn0iP0dzqnFHZfXSCJU7jDht9tNf9zuOneTTlB9ALUGZw1E2xCBkLmXSNhsBG7DqPdpsjih2eSJqCOWP0q02lDW2qZOu+wvWiJlFO2gh1F2WGjBPUowxXPsU1ijqlSZnqSSaCoQgb9ZL6k2xSCQH9N8EaXixdW4shpb0NywGpiom07761VD2+13qHJl6qM5BjEfpjCm83gddbBIT/kA3yHf1MvNr8E8d8Z92o1NafzjKTUwT2jQAjtysVNp8QS7XqsIDzb0W9A8L81SBJts9kqz0oz8ZJsaI8f5od3jt7bff2kc72ZeKUWjQFVBxAdodjYhxdN5a/D8LJMDRu1j1BkKt5jucsl2Ggejku10tjf+0tjch/dOm0a0HwZg1nG6awGzLzTdl17Q3pBfdOJ0mDp9e/zUYZwx6aix6S1S3c+m+ufpiTa116mtNUIU7sdUW2lvf09fRXKd30AZivoWFOMCeQf3f/gD+64ELAgBT1YAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='sdscatprintf.png' title='' src='/static/807e28c3d34eaab9100a132451f66a54/274fb/sdscatprintf.png' srcset='/static/807e28c3d34eaab9100a132451f66a54/e7570/sdscatprintf.png 170w,\n/static/807e28c3d34eaab9100a132451f66a54/f46e7/sdscatprintf.png 340w,\n/static/807e28c3d34eaab9100a132451f66a54/274fb/sdscatprintf.png 616w' sizes='(max-width: 616px) 100vw, 616px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>sdscatprintf.png</figcaption>\n  </figure></p>\n<ol>\n<li>\n<p><a href=\"https://github.com/antirez/sds#formatting-strings\">sds repo</a> 공식 레포에서 문자열 더하는 부분을 찾았습니다.</p>\n<ul>\n<li>라이브러리를 이해하기 전까지는 변수명이 왜 이럴까 궁금했습니다. </li>\n<li>cat, print가 한꺼번에 있으니.. 대충 의미는 알겠지만..</li>\n<li>sds.c 파일에서 주석을 보고 믿고 사용했습니다.</li>\n</ul>\n</li>\n<li>\n<p>addReplyBulkSds를 사용하려고 했습니다.</p>\n<ul>\n<li>하지만 server.c에는 addReplyBulkSds를 사용하지 않고 있어서 고민이 커졌습니다.  </li>\n<li>addReplyBulkCBuffer를 선택한 이유는 ping 명령어를 보고 참조했습니다.</li>\n</ul>\n</li>\n</ol>\n<h3>After(접미사)</h3>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">void</span> <span class=\"token function\">echoSiYeonCommand</span><span class=\"token punctuation\">(</span>client <span class=\"token operator\">*</span>c<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    sds suffixSYtoEcho <span class=\"token operator\">=</span> <span class=\"token function\">sdscatfmt</span><span class=\"token punctuation\">(</span><span class=\"token function\">sdsempty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"%s_SY\"</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">-></span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">-></span>ptr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">addReplyBulkSds</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> suffixSYtoEcho<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>\n<p>sdscatprintf에서 sdscatfmt 변경\n<figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/e021c07e6889944c90565126940517f3/acc8c/2year.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 71.17647058823529%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABiUlEQVR42pVUi26DMBDr/3/nNHWUJuRBHhC42UdR122gLdIpISQ+n31wqdMkOWcxd4O56DqlJOu6yjgmKaVKiKPYwYsP8Rk+yIhzuRS9l3CvtSYXORk8OCEhQfUi5oS9Wre9OI4bWMr6bp7nJyAZfR/KAJmDT+LsqExzCMqc7wjc2qLM9nHOEKx42NogzkVluy4AQCwg8BuJc4Zg0pYm/p7l+mbFA5RlfmV0CHik4Tw3aQm6QaOjxC+ApVbV46PrNDufeWWCwKoZXQZTjzXddXB3j8F5GTDvzlOKy0I9UMIEIJbyZLBqK0zTrC1iB6cAxg66ZvRoNYtn7pdHBaclk3FFImZXZ8ekzzSLDnMmEPdYEXv6FJD9VbUPi4Kxz3Ydj+IUkNpSU5Z86++b65CFwHv8z+VH98eYxEAz51F62r4YzilXJJxQ7h8am/RDsFLyIG4wMtgeTG/izFVSNDJXL22OMHQLWZPGZVU/fwa/hBgdsqOZTSe37l2M6SU6A+cDQJIsC38i+SU+Ae0PSuplPVYyAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='Twoyear.png' title='' src='/static/e021c07e6889944c90565126940517f3/ca1dc/2year.png' srcset='/static/e021c07e6889944c90565126940517f3/e7570/2year.png 170w,\n/static/e021c07e6889944c90565126940517f3/f46e7/2year.png 340w,\n/static/e021c07e6889944c90565126940517f3/ca1dc/2year.png 680w,\n/static/e021c07e6889944c90565126940517f3/acc8c/2year.png 989w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>Twoyear.png</figcaption>\n  </figure></p>\n<ul>\n<li>코드의 만들어진 시점은 대략 2년 정도 차이가 납니다.</li>\n<li>SDS는 레디스에 함께 있다가 따로 나온 버전이 1.0인데요. 그 버전에 sdscatprintf 포함이 되어 있습니다. </li>\n<li>sdscatfmt는 SDS 2.0 버전으로 업그레이드할 때 간단한 작업에서 사용할 수 있게 성능을 개선 했습니다.</li>\n</ul>\n</li>\n</ul>\n<h2>PS</h2>\n<ul>\n<li>\n<p>생각보다 오픈소스에서 고민해야 하는 것이 많다는 것을 깨닫게 됐습니다.</p>\n<ul>\n<li>어떤 식으로 의사결정 하는지 그리고 코드가 어떻게 만들어지고 사용되는지 등</li>\n</ul>\n</li>\n<li>명령어들이 처음 만들어진 것을 보고 아랫부분에 개선되는 버전들이 나오는 것을 알게 됐습니다.</li>\n<li>\n<p>SDS에서 ReadME에 앞줄에 sdscatprintf -> sdscatfmt 이거 쓰라고 한 부분을 유심히 봤다면 바로 사용했을 텐데 아쉬움이 남았습니다.</p>\n<ul>\n<li>아마도 변수명이 마음에 들지 않아서 좀 더 간결하게 바꾸지 않았을까 생각이 듭니다.</li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"4주차-Redis 명령어 코드 품질 높이기","date":"November 05, 2023","update":"November 05, 2023","tags":["Redis"],"series":"OSSCA Redis"},"fields":{"slug":"/OSSCA-4-week/","readingTime":{"minutes":2.805}}},"seriesList":{"edges":[{"node":{"id":"69f5fe8a-9052-57c3-85b6-c109e6f89503","fields":{"slug":"/OSSCA-1-week/"},"frontmatter":{"title":"1주차-Git"}}},{"node":{"id":"dddbe019-d901-53f9-b1f3-0de4f3d9c41e","fields":{"slug":"/OSSCA-2-week/"},"frontmatter":{"title":"2주차-Redis Build"}}},{"node":{"id":"71146c25-aed5-5c5a-9561-c33489800318","fields":{"slug":"/OSSCA-3-week/"},"frontmatter":{"title":"3주차-Redis 명령어 만들기"}}},{"node":{"id":"5a046d0b-e326-5871-8f18-0598fb3645fc","fields":{"slug":"/OSSCA-4-week/"},"frontmatter":{"title":"4주차-Redis 명령어 코드 품질 높이기"}}}]},"previous":{"fields":{"slug":"/OSSCA-3-week/"},"frontmatter":{"title":"3주차-Redis 명령어 만들기"}},"next":null},"pageContext":{"id":"5a046d0b-e326-5871-8f18-0598fb3645fc","series":"OSSCA Redis","previousPostId":"71146c25-aed5-5c5a-9561-c33489800318","nextPostId":null}},"staticQueryHashes":[],"slicesMap":{}}